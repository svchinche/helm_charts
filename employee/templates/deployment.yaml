apiVersion: apps/v1
kind: Deployment
metadata:
   name: emp-ms
   namespace: ccoms
   labels:
      app: emp-ms
spec:
   replicas: 3
   strategy:
      type: RollingUpdate
      rollingUpdate:
         maxSurge: 1
         maxUnavailable: 50%
   revisionHistoryLimit: 5
   selector:
      matchLabels:
         app: emp-ms
   template:
      metadata:
         labels:
            app: emp-ms
      spec:
         containers:
         -  name: emp-ms
            image: compucomm/emp-service:1.2
            imagePullPolicy: Always
            ports:
            -  containerPort: 8080
            env:
            - name: app.profile
              value: dev
            - name: CCOMS_DATABASE_USERNAME
              value: admin
            - name: CCOMS_DATABASE_PASSWORD
              value: admin123
            - name: CCOMS_DATABASE_SERVICENAME
              value: admin
            - name: CCOMS_DATABASE_PORT
              value: "27017"
            - name: CCOMS_EMP_PORT
              value: "8080"
            readinessProbe:
               httpGet:
                  path: /pretty
                  port: 8080
               initialDelaySeconds: 120
               periodSeconds: 10
               successThreshold: 1
            livenessProbe:
               httpGet:
                  path: /pretty
                  port: 8080
               initialDelaySeconds: 120
               periodSeconds: 10
               successThreshold: 1